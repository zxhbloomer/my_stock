# My Stock é¡¹ç›®è®¾è®¡æ–‡æ¡£

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: My Stock
**æŠ€æœ¯æ¡†æ¶**: Microsoft Qlib
**ç›®æ ‡å¸‚åœº**: ä¸­å›½Aè‚¡ (CSI300, CSI500ç­‰)
**é¡¹ç›®ç±»å‹**: é‡åŒ–æŠ•èµ„ç ”ç©¶å¹³å°

## äºŒã€é¡¹ç›®ç»“æ„è®¾è®¡

### 2.1 ç›®å½•ç»“æ„ï¼ˆåŸºäºå®˜æ–¹ç¤ºä¾‹ï¼‰

```
my_stock/
â”œâ”€â”€ configs/                    # YAML é…ç½®æ–‡ä»¶ï¼ˆå‚è€ƒ qlib/examples/benchmarksï¼‰
â”‚   â”œâ”€â”€ workflow_config_lightgbm_Alpha158.yaml
â”‚   â””â”€â”€ workflow_config_lightgbm_Alpha158_csi500.yaml
â”‚
â”œâ”€â”€ notebooks/                  # Jupyter Notebook åˆ†æ
â”‚   â”œâ”€â”€ 01_workflow_by_code.ipynb
â”‚   â””â”€â”€ 02_data_exploration.ipynb
â”‚
â”œâ”€â”€ scripts/                    # æ•°æ®å’Œè¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ download_data.bat
â”‚   â””â”€â”€ run_example.bat
â”‚
â”œâ”€â”€ examples/                   # å®˜æ–¹ç¤ºä¾‹å‚è€ƒ
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ mlruns/                     # MLflow å®éªŒè®°å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .gitignore
â””â”€â”€ å¿«é€Ÿå¼€å§‹.txt
```

### 2.2 è®¾è®¡åŸåˆ™

âœ… **åŸºäºå®˜æ–¹ç¤ºä¾‹**: æ‰€æœ‰é…ç½®æ–‡ä»¶å’Œä»£ç ç»“æ„ä¸¥æ ¼å‚è€ƒ Qlib å®˜æ–¹æ–‡æ¡£
âœ… **é…ç½®é©±åŠ¨**: ä½¿ç”¨ YAML é…ç½®æ–‡ä»¶å®šä¹‰ç­–ç•¥ï¼Œé¿å…ç¡¬ç¼–ç 
âœ… **å®éªŒç®¡ç†**: ä½¿ç”¨ MLflow è‡ªåŠ¨è®°å½•æ‰€æœ‰å®éªŒ
âœ… **ç®€å•å®ç”¨**: ä¸“æ³¨äºå­¦ä¹ å’Œç ”ç©¶ï¼Œä¸æ·»åŠ è‡ƒè‚¿åŠŸèƒ½

## ä¸‰ã€æ ¸å¿ƒç»„ä»¶

### 3.1 é…ç½®æ–‡ä»¶ç³»ç»Ÿ

æ‰€æœ‰é…ç½®æ–‡ä»¶éµå¾ª Qlib å®˜æ–¹æ ¼å¼ï¼š

```yaml
qlib_init:                    # Qlib åˆå§‹åŒ–
    provider_uri: "..."       # æ•°æ®è·¯å¾„
    region: cn                # åŒºåŸŸ

market: csi300                # å¸‚åœº
benchmark: SH000300           # åŸºå‡†

task:                         # ä»»åŠ¡å®šä¹‰
    model:                    # æ¨¡å‹é…ç½®
        class: LGBModel
        module_path: qlib.contrib.model.gbdt
        kwargs: {...}

    dataset:                  # æ•°æ®é›†é…ç½®
        class: DatasetH
        module_path: qlib.data.dataset
        kwargs: {...}

    record:                   # è®°å½•å™¨é…ç½®
        - class: SignalRecord
        - class: PortAnaRecord
```

### 3.2 æ•°æ®ç®¡ç†

**æ•°æ®æ¥æº**: Qlib å®˜æ–¹æ•°æ®
**æ•°æ®è·¯å¾„**: `~/.qlib/qlib_data/cn_data`
**æ•°æ®æ ¼å¼**: Qlib æ ‡å‡†æ ¼å¼ï¼ˆ.bin æ–‡ä»¶ï¼‰

**æ•°æ®ç»“æ„**ï¼ˆå‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼‰:
```
~/.qlib/qlib_data/cn_data/
â”œâ”€â”€ calendars/
â”‚   â””â”€â”€ day.txt
â”œâ”€â”€ instruments/
â”‚   â”œâ”€â”€ all.txt
â”‚   â”œâ”€â”€ csi300.txt
â”‚   â””â”€â”€ csi500.txt
â””â”€â”€ features/
    â”œâ”€â”€ sh600000/
    â”‚   â”œâ”€â”€ open.day.bin
    â”‚   â”œâ”€â”€ close.day.bin
    â”‚   â””â”€â”€ ...
    â””â”€â”€ ...
```

### 3.3 å®éªŒç®¡ç†

ä½¿ç”¨ Qlib å†…ç½®çš„ MLflow é›†æˆï¼š

```python
from qlib.workflow import R

with R.start(experiment_name="my_experiment"):
    # è®­ç»ƒæ¨¡å‹
    model.fit(dataset)
    R.save_objects(trained_model=model)

    # ç”Ÿæˆé¢„æµ‹
    sr = SignalRecord(model, dataset, R.get_recorder())
    sr.generate()

    # å›æµ‹
    par = PortAnaRecord(R.get_recorder(), config, "day")
    par.generate()
```

## å››ã€ä½¿ç”¨æµç¨‹

### 4.1 åˆå§‹åŒ–æµç¨‹

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. ä¸‹è½½æ•°æ®
scripts\download_data.bat

# 3. è¿è¡Œç¤ºä¾‹
scripts\run_example.bat

# 4. æŸ¥çœ‹ç»“æœ
mlflow ui
```

### 4.2 ç ”ç©¶æµç¨‹

1. **æ•°æ®æ¢ç´¢** â†’ `notebooks/02_data_exploration.ipynb`
2. **ç­–ç•¥å¼€å‘** â†’ ä¿®æ”¹ `configs/` ä¸­çš„é…ç½®æ–‡ä»¶
3. **æ¨¡å‹è®­ç»ƒ** â†’ `qrun configs/your_config.yaml`
4. **ç»“æœåˆ†æ** â†’ MLflow UI æˆ– Jupyter Notebook
5. **è¿­ä»£ä¼˜åŒ–** â†’ è°ƒæ•´å‚æ•°ï¼Œé‡å¤ 2-4

### 4.3 å¤šç­–ç•¥ç®¡ç†

```bash
# ç­–ç•¥1: CSI300 + LightGBM
qrun configs/workflow_config_lightgbm_Alpha158.yaml

# ç­–ç•¥2: CSI500 + LightGBM
qrun configs/workflow_config_lightgbm_Alpha158_csi500.yaml

# æŸ¥çœ‹å¯¹æ¯”
mlflow ui  # åœ¨ UI ä¸­å¯¹æ¯”ä¸åŒå®éªŒ
```

## äº”ã€é…ç½®è¯´æ˜

### 5.1 å¸‚åœºé…ç½®

æ”¯æŒçš„å¸‚åœºï¼ˆæ¥è‡ª Qlibï¼‰:
- `csi300` - æ²ªæ·±300
- `csi500` - ä¸­è¯500
- `csi100` - ä¸­è¯100
- `all` - å…¨å¸‚åœº

å¯¹åº”åŸºå‡†:
- CSI300 â†’ `SH000300`
- CSI500 â†’ `SH000905`
- CSI100 â†’ `SH000903`

### 5.2 æ¨¡å‹é…ç½®

å½“å‰æ”¯æŒï¼ˆåŸºäº Qlib å†…ç½®ï¼‰:
- `LGBModel` - LightGBM (qlib.contrib.model.gbdt)
- `LinearModel` - çº¿æ€§æ¨¡å‹
- æ›´å¤šæ¨¡å‹å‚è€ƒ Qlib å®˜æ–¹æ–‡æ¡£

### 5.3 å› å­é…ç½®

å½“å‰ä½¿ç”¨ï¼ˆåŸºäº Qlib å†…ç½®ï¼‰:
- `Alpha158` - 158ä¸ªæŠ€æœ¯æŒ‡æ ‡
- `Alpha360` - 360ä¸ªæŠ€æœ¯æŒ‡æ ‡

## å…­ã€æ‰©å±•æ–¹å¼

### 6.1 æ·»åŠ æ–°ç­–ç•¥

```bash
# 1. å¤åˆ¶é…ç½®æ–‡ä»¶
cp configs/workflow_config_lightgbm_Alpha158.yaml \
   configs/my_new_strategy.yaml

# 2. ä¿®æ”¹é…ç½®
# - ä¿®æ”¹å¸‚åœº
# - ä¿®æ”¹æ¨¡å‹å‚æ•°
# - ä¿®æ”¹æ—¶é—´èŒƒå›´

# 3. è¿è¡Œ
qrun configs/my_new_strategy.yaml
```

### 6.2 è‡ªå®šä¹‰æ¨¡å‹ï¼ˆé«˜çº§ï¼‰

å‚è€ƒ Qlib å®˜æ–¹æ–‡æ¡£:
- [è‡ªå®šä¹‰æ¨¡å‹æ•™ç¨‹](https://qlib.readthedocs.io/en/latest/start/integration.html)
- [æ¨¡å‹æ¥å£è¯´æ˜](https://qlib.readthedocs.io/en/latest/component/model.html)

### 6.3 ä½¿ç”¨å®˜æ–¹é«˜çº§ç¤ºä¾‹

```bash
# å‚è€ƒå®˜æ–¹ä»“åº“
git clone https://github.com/microsoft/qlib.git

# æŸ¥çœ‹é«˜çº§ç¤ºä¾‹
cd qlib/examples/benchmarks
# - TRA (Transformer)
# - HIST (å›¾ç¥ç»ç½‘ç»œ)
# - LSTM ç­‰
```

## ä¸ƒã€æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| æ ¸å¿ƒæ¡†æ¶ | Qlib | Microsoft é‡åŒ–æŠ•èµ„æ¡†æ¶ |
| æ•°æ®å¤„ç† | Pandas | æ•°æ®åˆ†æ |
| æœºå™¨å­¦ä¹  | LightGBM | æ¢¯åº¦æå‡æ ‘ |
| å®éªŒç®¡ç† | MLflow | å†…ç½®äº Qlib |
| é…ç½®ç®¡ç† | YAML | æ ‡å‡†é…ç½®æ ¼å¼ |
| åˆ†æå·¥å…· | Jupyter | äº¤äº’å¼åˆ†æ |

## å…«ã€å‚è€ƒèµ„æº

### å®˜æ–¹èµ„æº
- [Qlib æ–‡æ¡£](https://qlib.readthedocs.io/)
- [Qlib GitHub](https://github.com/microsoft/qlib)
- [ç¤ºä¾‹ä»£ç ](https://github.com/microsoft/qlib/tree/main/examples)

### é…ç½®å‚è€ƒ
- [å·¥ä½œæµé…ç½®](https://qlib.readthedocs.io/en/latest/component/workflow.html)
- [æ¨¡å‹é…ç½®](https://qlib.readthedocs.io/en/latest/component/model.html)
- [ç­–ç•¥é…ç½®](https://qlib.readthedocs.io/en/latest/component/strategy.html)

## ä¹ã€æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦æé†’**:

1. **æ•°æ®è·¯å¾„**: ç¡®ä¿æ•°æ®å·²ä¸‹è½½åˆ° `~/.qlib/qlib_data/cn_data`
2. **é…ç½®æ ¼å¼**: ä¸¥æ ¼éµå¾ª YAML è¯­æ³•ï¼Œæ³¨æ„ç¼©è¿›
3. **å®éªŒå‘½å**: ä½¿ç”¨æœ‰æ„ä¹‰çš„å®éªŒåç§°ï¼Œæ–¹ä¾¿åç»­æŸ¥æ‰¾
4. **ç‰ˆæœ¬æ§åˆ¶**: é…ç½®æ–‡ä»¶å»ºè®®ä½¿ç”¨ Git ç®¡ç†
5. **æ€§èƒ½è€ƒè™‘**: å¤§è§„æ¨¡å›æµ‹éœ€è¦è¾ƒå¤šå†…å­˜å’Œè®¡ç®—èµ„æº

## åã€åç»­è§„åˆ’

### é˜¶æ®µ1: ç†Ÿæ‚‰æ¡†æ¶ï¼ˆå½“å‰ï¼‰
- âœ… æ­å»ºé¡¹ç›®ç»“æ„
- âœ… è¿è¡Œå®˜æ–¹ç¤ºä¾‹
- ğŸ“ å­¦ä¹  Qlib æ ¸å¿ƒæ¦‚å¿µ

### é˜¶æ®µ2: ç­–ç•¥ç ”ç©¶
- ğŸ“ æµ‹è¯•ä¸åŒå› å­ç»„åˆ
- ğŸ“ å¯¹æ¯”ä¸åŒæ¨¡å‹æ•ˆæœ
- ğŸ“ ä¼˜åŒ–å›æµ‹å‚æ•°

### é˜¶æ®µ3: é«˜çº§åŠŸèƒ½
- ğŸ“ å®ç°è‡ªå®šä¹‰å› å­
- ğŸ“ é›†æˆé«˜çº§æ¨¡å‹ï¼ˆLSTM, Transformerï¼‰
- ğŸ“ å¤šç­–ç•¥ç»„åˆä¼˜åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¥æœŸ**: 2025-01-08
**ç»´æŠ¤è€…**: My Stock Project
